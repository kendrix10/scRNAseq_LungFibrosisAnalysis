y = "% ANTXR1+ expressed per total cells for each timepoint
(Blank = > 0.001 or 0.1%)",
fill = element_blank()) +
ylim(0, 7) +
scale_fill_manual(values = celltype_col) +
theme_linedraw() +
theme(axis.text.x = element_text(size = 12,
angle = 90,
hjust = 1,
vjust = 0.5),
strip.text = element_text(size = 15))
# Visualize the ANTXR1+ cell type clusters.
FeaturePlot(seurat_obj,
reduction = "umap",
features = "Antxr1",
split.by = "timepoint",
pt.size = 0.8,
label = TRUE,
label.size = 3,
repel = TRUE,
order = TRUE,
ncol = 2,
cols = c("#d3d3d3", "#edc9af", "#6e260e")) +
patchwork::plot_layout(ncol = 3, nrow = 3) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 15))
# Visualize ANTXR1 expressed by total cells as barplot.
celltype_timepoint_counts_mice %>%
group_by(cell_type, timepoint) %>%
summarise(n = n(),
mean = plyr::round_any(mean(Antxr1_by_totalcells),
accuracy = 0.01,
f = ceiling),
sd = plyr::round_any(sd(Antxr1_by_totalcells),
accuracy = 0.01,
f = ceiling),
.groups = "drop") %>%
mutate(se = plyr::round_any(sd/sqrt(n),
accuracy = 0.01,
f = ceiling)) %>%
ggplot(aes(x = cell_type,
y = mean,
fill = cell_type)) +
geom_col(show.legend = FALSE) +
geom_errorbar(aes(ymin = mean-se,
ymax = mean+se),
width = 0.4,
alpha = 0.9) +
geom_text(aes(label = mean,
vjust = 0.5,
hjust = -0.8),
size = 5,
angle = 90) +
facet_wrap(~timepoint) +
labs(x = "Cell type",
y = "% ANTXR1+ expressed per total cells for each timepoint
(Blank = > 0.001 or 0.1%)",
fill = element_blank()) +
ylim(0, 8) +
scale_fill_manual(values = celltype_col) +
theme_linedraw() +
theme(axis.text.x = element_text(size = 12,
angle = 90,
hjust = 1,
vjust = 0.5),
strip.text = element_text(size = 15))
# Visualize the ANTXR1+ cell type clusters.
FeaturePlot(seurat_obj,
reduction = "umap",
features = "Antxr1",
split.by = "timepoint",
pt.size = 0.8,
label = TRUE,
label.size = 3,
repel = TRUE,
order = TRUE,
ncol = 2,
cols = c("#d3d3d3", "#edc9af", "#6e260e")) +
patchwork::plot_layout(ncol = 3, nrow = 3) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 15))
# Visualize ANTXR1 expressed by total cells as barplot.
celltype_timepoint_counts_mice %>%
group_by(cell_type, timepoint) %>%
summarise(n = n(),
mean = plyr::round_any(mean(Antxr1_by_totalcells),
accuracy = 0.01,
f = ceiling),
sd = plyr::round_any(sd(Antxr1_by_totalcells),
accuracy = 0.01,
f = ceiling),
.groups = "drop") %>%
mutate(se = plyr::round_any(sd/sqrt(n),
accuracy = 0.01,
f = ceiling)) %>%
ggplot(aes(x = cell_type,
y = mean,
fill = cell_type)) +
geom_col(show.legend = FALSE) +
geom_errorbar(aes(ymin = mean-se,
ymax = mean+se),
width = 0.4,
alpha = 0.9) +
geom_text(aes(label = mean,
vjust = 0.5,
hjust = -0.8),
size = 5,
angle = 90) +
facet_wrap(~timepoint) +
labs(x = "Cell type",
y = "% ANTXR1+ expressed per total cells for each timepoint
(Blank = > 0.001 or 0.1%)",
fill = element_blank()) +
ylim(0, 10) +
scale_fill_manual(values = celltype_col) +
theme_linedraw() +
theme(axis.text.x = element_text(size = 12,
angle = 90,
hjust = 1,
vjust = 0.5),
strip.text = element_text(size = 15))
# Visualize ANTXR1 expressed by total cells as barplot.
celltype_timepoint_counts_mice %>%
group_by(cell_type, timepoint) %>%
summarise(n = n(),
mean = plyr::round_any(mean(Antxr1_by_totalcells),
accuracy = 0.01,
f = ceiling),
sd = plyr::round_any(sd(Antxr1_by_totalcells),
accuracy = 0.01,
f = ceiling),
.groups = "drop") %>%
mutate(se = plyr::round_any(sd/sqrt(n),
accuracy = 0.01,
f = ceiling)) %>%
ggplot(aes(x = cell_type,
y = mean,
fill = cell_type)) +
geom_col(show.legend = FALSE) +
geom_errorbar(aes(ymin = mean-se,
ymax = mean+se),
width = 0.4,
alpha = 0.9) +
geom_text(aes(label = mean,
vjust = 0.5,
hjust = -0.8),
size = 5,
angle = 90) +
facet_wrap(~timepoint) +
labs(x = "Cell type",
y = "% ANTXR1+ expressed per total cells for each timepoint
(Blank = > 0.001 or 0.1%)",
fill = element_blank()) +
ylim(0, 10) +
scale_fill_manual(values = celltype_col) +
theme_linedraw() +
theme(axis.text.x = element_text(size = 12,
angle = 90,
hjust = 1,
vjust = 0.5),
strip.text = element_text(size = 15))
# Visualize the ANTXR1+ cell type clusters.
FeaturePlot(seurat_obj,
reduction = "umap",
features = "Antxr1",
split.by = "timepoint",
pt.size = 0.8,
label = TRUE,
label.size = 3,
repel = TRUE,
order = TRUE,
cols = c("#d3d3d3", "#edc9af", "#6e260e")) +
patchwork::plot_layout(ncol = 3, nrow = 3) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 15))
# Visualize ANTXR1 expressed by total cells per cell type as barplot.
celltype_timepoint_counts_mice %>%
group_by(cell_type, timepoint) %>%
summarise(n = n(),
mean = plyr::round_any(mean(Antxr1_by_celltypes),
accuracy = 0.01,
f = ceiling),
sd = plyr::round_any(sd(Antxr1_by_celltypes),
accuracy = 0.01,
f = ceiling),
.groups = "drop") %>%
mutate(se = plyr::round_any(sd/sqrt(n),
accuracy = 0.01,
f = ceiling)) %>%
ggplot(aes(x = cell_type,
y = mean,
fill = cell_type)) +
geom_col(show.legend = FALSE) +
geom_errorbar(aes(ymin = mean-se,
ymax = mean+se),
width = 0.4,
alpha = 0.9) +
geom_text(aes(label = mean,
vjust = 0.5,
hjust = -0.8),
size = 5,
angle = 90) +
facet_wrap(~timepoint) +
labs(x = "Cell type",
y = "% mean ANTXR1+ expressed per total cells for each cell type at each timepoint
(Blank = > 0.001 or 0.1%)",
fill = element_blank()) +
ylim(0, 110) +
scale_fill_manual(values = celltype_col) +
theme_linedraw() +
theme(axis.text.x = element_text(size = 12,
angle = 90,
hjust = 1,
vjust = 0.5),
strip.text = element_text(size = 15))
# Visualize the ANTXR1+ cell type clusters.
FeaturePlot(seurat_obj,
reduction = "umap",
features = "Antxr1",
split.by = "timepoint",
pt.size = 0.8,
label = TRUE,
label.size = 3,
repel = TRUE,
order = TRUE,
cols = c("#d3d3d3", "#edc9af", "#6e260e")) +
patchwork::plot_layout(ncol = 3, nrow = 3) +
theme(axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
strip.text = element_text(size = 15))
# Visualize ANTXR1 expressed by total cells per cell type as barplot.
celltype_timepoint_counts_mice %>%
group_by(cell_type, timepoint) %>%
summarise(n = n(),
mean = plyr::round_any(mean(Antxr1_by_celltypes),
accuracy = 0.01,
f = ceiling),
sd = plyr::round_any(sd(Antxr1_by_celltypes),
accuracy = 0.01,
f = ceiling),
.groups = "drop") %>%
mutate(se = plyr::round_any(sd/sqrt(n),
accuracy = 0.01,
f = ceiling)) %>%
ggplot(aes(x = cell_type,
y = mean,
fill = cell_type)) +
geom_col(show.legend = FALSE) +
geom_errorbar(aes(ymin = mean-se,
ymax = mean+se),
width = 0.4,
alpha = 0.9) +
geom_text(aes(label = mean,
vjust = 0.5,
hjust = -0.8),
size = 5,
angle = 90) +
facet_wrap(~timepoint) +
labs(x = "Cell type",
y = "% mean ANTXR1+ expressed per total cells for each cell type at each timepoint
(Blank = > 0.001 or 0.1%)",
fill = element_blank()) +
ylim(0, 110) +
scale_fill_manual(values = celltype_col) +
theme_linedraw() +
theme(axis.text.x = element_text(size = 12,
angle = 90,
hjust = 1,
vjust = 0.5),
strip.text = element_text(size = 15))
# Visualize ANTXR1 expressed by total cells per cell type as barplot.
celltype_timepoint_counts_mice %>%
group_by(cell_type, timepoint) %>%
summarise(n = n(),
mean = plyr::round_any(mean(Antxr1_by_celltypes),
accuracy = 0.01,
f = ceiling),
sd = plyr::round_any(sd(Antxr1_by_celltypes),
accuracy = 0.01,
f = ceiling),
.groups = "drop") %>%
mutate(se = plyr::round_any(sd/sqrt(n),
accuracy = 0.01,
f = ceiling)) %>%
ggplot(aes(x = cell_type,
y = mean,
fill = cell_type)) +
geom_col(show.legend = FALSE) +
geom_errorbar(aes(ymin = mean-se,
ymax = mean+se),
width = 0.4,
alpha = 0.9) +
geom_text(aes(label = mean,
vjust = 0.5,
hjust = -0.8),
size = 5,
angle = 90) +
facet_wrap(~timepoint) +
labs(x = "Cell type",
y = "% mean ANTXR1+ expressed per total cells for each cell type at each timepoint
(Blank = > 0.001 or 0.1%)",
fill = element_blank()) +
ylim(0, 110) +
scale_fill_manual(values = celltype_col) +
theme_linedraw() +
theme(axis.text.x = element_text(size = 12,
angle = 90,
hjust = 1,
vjust = 0.5),
strip.text = element_text(size = 15))
# Subset cell type of interest - AT2 cells.
AT2_cells <- subset(seurat_obj, idents = "AT2", invert = FALSE)
unique(AT2_cells$treatment)
AT2_cells$treatment <- factor(AT2_cells$treatment,
levels = c("untreated",
"bleomycin administered intratracheally"))
unique(AT2_cells$timepoint)
# Make expression comparisons between metadata of interest.
source("/Users/kendrix/Documents/Work/UnityHealth/Data_Projects/VlnPlot_stat.R")
VlnPlot_stat(object = AT2_cells,
gene_signature = c("Antxr1"),
test_sign = list(c("Untreated", "Day 3"),
c("Untreated", "Day 7"),
c("Untreated", "Day 14"),
c("Untreated", "Day 28"),
c("Untreated", "Day 42"),
c("Untreated", "Day 63"),
c("Day 3", "Day 7"),
c("Day 7", "Day 14"),
c("Day 14", "Day 28"),
c("Day 28", "Day 42"),
c("Day 42", "Day 63")),
group_name = "timepoint",
title = "ANTXR1 expression comparisons between
timepoints for AT2 cells")
VlnPlot_stat(object = AT2_cells,
gene_signature = c("Antxr1"),
test_sign = list(c("Untreated", "Day 3"),
c("Untreated", "Day 7"),
c("Untreated", "Day 14"),
c("Untreated", "Day 28"),
c("Untreated", "Day 42"),
c("Untreated", "Day 63")),
group_name = "timepoint",
title = "ANTXR1 expression comparisons between
timepoints for AT2 cells")
VlnPlot_stat(object = AT2_cells,
gene_signature = c("Antxr1"),
test_sign = list(c("Untreated", "Day 3"),
c("Untreated", "Day 7"),
c("Untreated", "Day 14"),
c("Untreated", "Day 28"),
c("Untreated", "Day 42"),
c("Untreated", "Day 63")),
group_name = "timepoint",
title = "ANTXR1 pairwise comparisons between control and BLM-treatment
at different timepoints")
grep("ibro", seurat_obj$cell_type, value = TRUE) %>% unique()
# Subset cell type of interest - AT2 cells.
AT2_cells <- subset(seurat_obj, idents = "AT2", invert = FALSE)
AT2_cells$treatment <- factor(AT2_cells$treatment,
levels = c("untreated",
"bleomycin administered intratracheally"))
# Make expression comparisons between metadata of interest.
source("/Users/kendrix/Documents/Work/UnityHealth/Data_Projects/VlnPlot_stat.R")
VlnPlot_stat(object = AT2_cells,
gene_signature = c("Antxr1"),
test_sign = list(c("Untreated", "Day 3"),
c("Untreated", "Day 7"),
c("Untreated", "Day 14"),
c("Untreated", "Day 28"),
c("Untreated", "Day 42"),
c("Untreated", "Day 63")),
group_name = "timepoint",
title = "ANTXR1 pairwise comparisons between control and BLM-treated AT2 cells
at different timepoints")
# Remove unneeded objects.
rm(AT2_cells)
# Subset cell type of interest - Fibroblasts, Myofibroblasts & Fibromyocytes.
Fibro_cells <- subset(seurat_obj,
idents = c("Fibroblasts", "Myofibroblasts", "Fibromyocytes"),
invert = FALSE)
Fibro_cells$treatment <- factor(Fibro_cells$treatment,
levels = c("untreated",
"bleomycin administered intratracheally"))
# Make expression comparisons between metadata of interest.
source("/Users/kendrix/Documents/Work/UnityHealth/Data_Projects/VlnPlot_stat.R")
VlnPlot_stat(object = Fibro_cells,
gene_signature = c("Antxr1"),
test_sign = list(c("Untreated", "Day 3"),
c("Untreated", "Day 7"),
c("Untreated", "Day 14"),
c("Untreated", "Day 28"),
c("Untreated", "Day 42"),
c("Untreated", "Day 63")),
group_name = "timepoint",
title = "ANTXR1 pairwise comparisons between control and BLM-treated fibroblasts
at different timepoints")
# Remove unneeded objects.
rm(Fibro_cells)
# Subset cell type of interest - AT2 cells.
AT2_cells <- subset(seurat_obj, idents = "AT2", invert = FALSE)
AT2_cells$treatment <- factor(AT2_cells$treatment,
levels = c("untreated",
"bleomycin administered intratracheally"))
# Make expression comparisons between metadata of interest.
source("/Users/kendrix/Documents/Work/UnityHealth/Data_Projects/VlnPlot_stat.R")
VlnPlot_stat(object = AT2_cells,
gene_signature = c("Antxr1"),
test_sign = list(c("Untreated", "Day 3"),
c("Untreated", "Day 7"),
c("Untreated", "Day 14"),
c("Untreated", "Day 28"),
c("Untreated", "Day 42"),
c("Untreated", "Day 63")),
group_name = "timepoint",
title = "ANTXR1 pairwise comparisons between control and BLM-treated AT2 cells
at different timepoints")
# Remove unneeded objects.
rm(AT2_cells)
# Subset cell type of interest - Fibroblasts, Myofibroblasts & Fibromyocytes.
Fibro_cells <- subset(seurat_obj,
idents = c("Fibroblasts", "Myofibroblasts", "Fibromyocytes"),
invert = FALSE)
Fibro_cells$treatment <- factor(Fibro_cells$treatment,
levels = c("untreated",
"bleomycin administered intratracheally"))
# Make expression comparisons between metadata of interest.
source("/Users/kendrix/Documents/Work/UnityHealth/Data_Projects/VlnPlot_stat.R")
VlnPlot_stat(object = Fibro_cells,
gene_signature = c("Antxr1"),
test_sign = list(c("Untreated", "Day 3"),
c("Untreated", "Day 7"),
c("Untreated", "Day 14"),
c("Untreated", "Day 28"),
c("Untreated", "Day 42"),
c("Untreated", "Day 63")),
group_name = "timepoint",
title = "ANTXR1 pairwise comparisons between control and BLM-treated fibroblasts
at different timepoints")
# Remove unneeded objects.
rm(Fibro_cells)
# Subset cell type of interest - AT2 cells.
AT2_cells <- subset(seurat_obj, idents = "AT2", invert = FALSE)
AT2_cells$treatment <- factor(AT2_cells$treatment,
levels = c("untreated",
"bleomycin administered intratracheally"))
# Make expression comparisons between metadata of interest.
source("/Users/kendrix/Documents/Work/UnityHealth/Data_Projects/VlnPlot_stat.R")
VlnPlot_stat(object = AT2_cells,
gene_signature = c("Antxr1"),
test_sign = list(c("Untreated", "Day 3"),
c("Untreated", "Day 7"),
c("Untreated", "Day 14"),
c("Untreated", "Day 28"),
c("Untreated", "Day 42"),
c("Untreated", "Day 63")),
group_name = "timepoint",
title = "ANTXR1 pairwise comparisons between control and BLM-treated AT2 cells
at different timepoints")
# Remove unneeded objects.
rm(AT2_cells)
# Subset cell type of interest - Fibroblasts, Myofibroblasts & Fibromyocytes.
Fibro_cells <- subset(seurat_obj,
idents = c("Fibroblasts", "Myofibroblasts", "Fibromyocytes"),
invert = FALSE)
Fibro_cells$treatment <- factor(Fibro_cells$treatment,
levels = c("untreated",
"bleomycin administered intratracheally"))
# Make expression comparisons between metadata of interest.
source("/Users/kendrix/Documents/Work/UnityHealth/Data_Projects/VlnPlot_stat.R")
VlnPlot_stat(object = Fibro_cells,
gene_signature = c("Antxr1"),
test_sign = list(c("Untreated", "Day 3"),
c("Untreated", "Day 7"),
c("Untreated", "Day 14"),
c("Untreated", "Day 28"),
c("Untreated", "Day 42"),
c("Untreated", "Day 63")),
group_name = "timepoint",
title = "ANTXR1 pairwise comparisons between control and BLM-treated fibroblasts
at different timepoints")
# Remove unneeded objects.
rm(Fibro_cells)
grep("Endothelial", seurat_obj$cell_type, value = TRUE) %>% unique()
# Subset cell type of interest - Endothelial cells.
EC_cells <- subset(seurat_obj,
idents = c("Endothelial arterial",
"Endothelial venous",
"Endothelial capillary"),
invert = FALSE)
EC_cells$treatment <- factor(EC_cells$treatment,
levels = c("untreated",
"bleomycin administered intratracheally"))
# Make expression comparisons between metadata of interest.
source("/Users/kendrix/Documents/Work/UnityHealth/Data_Projects/VlnPlot_stat.R")
VlnPlot_stat(object = EC_cells,
gene_signature = c("Antxr1"),
test_sign = list(c("Untreated", "Day 3"),
c("Untreated", "Day 7"),
c("Untreated", "Day 14"),
c("Untreated", "Day 28"),
c("Untreated", "Day 42"),
c("Untreated", "Day 63")),
group_name = "timepoint",
title = "ANTXR1 pairwise comparisons between control and BLM-treated
endothelial cells at different timepoints")
# Remove unneeded objects.
rm(EC_cells)
